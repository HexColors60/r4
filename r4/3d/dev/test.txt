^r4/lib/gui.txt

#l 0

:nlin
	2dup + l 4+ gotoxy
	0? ( "*" print ; )
	dup "|" print neg ( 1? )( 1- "-" print ) drop
	;
:lin | w

	-? ( nlin ; )
	over l 4+ gotoxy
	0? ( "*" print ; )
	dup ( 1? )( 1- "-" print ) "|" print drop
	;

#la -3
#set )( 1024

:set.cl
	'set >r
	20 ( 1? )( 1- 0 r!+ ) drop
	rdrop
	;
:set! | n
	1 swap 'set + +! ;

:drawset
	'set 80
	( 1? )( 1-
		swap c@+ "%d" print swap ) 2drop ;


:rec
	lin 0? ( drop set! ; )
	1 'l +!

|**	2dup -1 =? ( 1+ )( 2/ )
|	2dup 1+ 1? ( 1- 2/ )
	2dup -? ( neg 2/ neg )( 2/ ) | largo hijo 1
	rec

|	sign over
|	1+ 1? ( 1- 2/ )
|	+
	dup
	1? ( -? ( neg 2/ 1+ neg )( 2/ 1+ ) ) | largo hijo 2

	rot over + rot rot -
	rec
	-1 'l +!
	;

:main
	33
	show clrscr
		dup la "%d %d" print cr
		set.cl
		30 la rec
		[ -1 'la +! ; ] <le>
		[ 1 'la +! ; ] <ri>

		0 20 gotoxy
		drawset
		cr
		0  1? ( -? ( neg 2/ 1+ neg )( 2/ 1+ ) ) "%d" print
	'exit >esc<
	;

: main ;
