| save uncompress png
| PHREDA 2017
|---------------
^r4/lib/crc32.txt

#wp #hp
#size

:crc | desde --- crc
	here over - swap crc32 ;

:,32 dup 24 >> ,c dup 16 >> ,c dup 8 >> ,c ,c ;

:header
	$89 ,c $50 ,c $4E ,c $47 ,c $0D ,c $0A ,c $1A ,c $0A ,c	| PNG header
	$00 ,c $00 ,c $00 ,c $0D ,c $49 ,c $48 ,c $44 ,c $52 ,c | IHDR chunk
	wp ,32
	hp ,32
	$08 ,c $02 ,c $00 ,c $00 ,c $00 ,c
	17 crc ,32		| IHDR CRC-32 to be filled in (starting at offset 29)
	size ,32 | IDAT chunk
	$49 ,c $44 ,c $41 ,c $54 ,c
	$08 ,c $1D ,c 									| DEFLATE data
	;

:savepng | "" w h --
	'hp ! 'wp !
	mark
	header
	savemem
	empty ;