| carrera de frutas
| 2016

^r4/lib/gui.txt
^r4/dev/frutas.spr

#xf1 #xs1
#s11 #s12
#xj1 #yj1 #ay1 #sj1 #d1

#xf2 #xs2
#s21 #s22
#xj2 #yj2 #ay2 #sj2 #d2

#puntos1
#puntos2

:salto1
	sj1 0? ( 0.08 'ay1 ! 1 'sj1 ! ) drop ;

:saltando1
	-0.005 'ay1 +!
	ay1 'yj1 +!
	yj1 -? ( 0 'yj1 ! 0 'sj1 ! ) drop
	;

:valla1
	dup 'xs1 ! 1.0 'xf1 !
	s11 's12 !
	'valla 's11 !
	sj1 0? ( -1 'puntos1 +! -0.1 'xj1 +! 'vallarota 's12 ! ) drop ;

:j1
	1.0 dup dim
	128 'h !
	0 -0.5 fpos
	'arena nsprite

   	128 qdim
	xs1 -0.5 fpos
	s12 nsprite
	-0.01 'xs1 +!

	128 qdim
	xj1 yj1 0.5 - fpos
	'fruta nsprite
	'salto1 <up>
	sj1 1? ( saltando1 ) drop

   	128 qdim
	xf1 -0.5 fpos
	s11 nsprite
	-0.01 'xf1 +!

	xf1 xj1 <? ( valla1 ) drop
	;


:salto2
	sj2 0? ( 0.08 'ay2 ! 1 'sj2 ! ) drop ;

:saltando2
	-0.005 'ay2 +!
	ay2 'yj2 +!
	yj2 -? ( 0 'yj2 ! 0 'sj2 ! ) drop
	;

:valla2
	dup 'xs2 ! 1.0 'xf2 !
	s21 's22 !
	'valla 's21 !
	sj2 0? ( -1 'puntos2 +! -0.1 'xj2 +! 'vallarota 's22 ! ) drop ;

:j2
	1.0 dup dim
	128 'h !
	0 0.4 fpos
	'arena nsprite

   	128 qdim
	xs2 0.4 fpos
	s22 nsprite
	-0.01 'xs2 +!

	128 qdim
	xj2 yj2 0.4 + fpos
	'fruta nsprite
	'salto2 <ctrl>
	sj2 1? ( saltando2 ) drop

   	128 qdim
	xf2 0.4 fpos
	s21 nsprite
	-0.01 'xf2 +!

	xf2 xj2 <? ( valla2 ) drop
	;

:reset
	0 'd1 !
	0 'xj1 !
	0 'yj1 !
	0 'ay1 !
	0 'sj1 !

	1.0 'xf1 !
	-1.0 'xs1 !
	'valla 's11 !
	'valla 's12 !

	1.0 'xf2 !
	-1.0 'xs2 !
	'valla 's21 !
	'valla 's22 !

	;

:juego
	reset
	33
	show clrscr
		dup "%d " print cr
		puntos1 "%d " print

		j1
        j2
		'exit >esc< ;


: juego ;