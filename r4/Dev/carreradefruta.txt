| carrera de frutas
| 2016

^r4/lib/gui.txt
^r4/lib/anima.txt
^r4/dev/frutas.spr

#xf1 #xs1
#s11 #s12
#xj1 #yj1 #ay1 #sj1 #d1
#v1

#xf2 #xs2
#s21 #s22
#xj2 #yj2 #ay2 #sj2 #d2
#v2

#runa1 0 0 run1a 8 run2a 8 run3a 8 run4a 8 run5a 8 run6a 8 run7a 8 run8a 8 0
#runb1 0 0 run1b 8 run2b 8 run3b 8 run4b 8 run5b 8 run6b 8 run7b 8 run8b 8 0
#runa2 0 0 run1a 8 run2a 8 run3a 8 run4a 8 run5a 8 run6a 8 run7a 8 run8a 8 0
#runb2 0 0 run1b 8 run2b 8 run3b 8 run4b 8 run5b 8 run6b 8 run7b 8 run8b 8 0

#puntos1
#puntos2

:salto1
	sj1 0? ( 0.06 'ay1 ! 1 'sj1 ! ) drop ;

:saltando1
	-0.003 'ay1 +!
	ay1 'yj1 +!
	yj1 -? ( 0 'yj1 ! 0 'sj1 ! ) drop
	;

:valla1
	dup 'xs1 ! 1.0 'xf1 !
	s11 's12 !
	'valla 's11 !
	s12 'largada =? ( drop ; ) drop
	sj1 0? ( -1 'puntos1 +! 'vallarota 's12 ! ) drop ;

:j1
	1.0 dup dim
	128 'h !
	0 -0.5 fpos
	'arena nsprite

   	128 qdim
	xs1 -0.5 fpos
	s12 nsprite
	-0.005 'xs1 +!

	128 qdim
	xj1 yj1 0.5 - fpos
	'runa1 seqAnima nsprite
	'fruta1 nsprite
	'runb1 seqAnima nsprite
	'salto1 <up>
	sj1 1? ( saltando1 ) drop

   	128 qdim
	xf1 -0.5 fpos
	s11 nsprite
	-0.005 'xf1 +!

	xf1 xj1 <? ( valla1 ) drop
	;


:salto2
	sj2 0? ( 0.06 'ay2 ! 1 'sj2 ! ) drop ;

:saltando2
	-0.003 'ay2 +!
	ay2 'yj2 +!
	yj2 -? ( 0 'yj2 ! 0 'sj2 ! ) drop
	;

:valla2
	dup 'xs2 ! 1.0 'xf2 !
	s21 's22 !
	'valla 's21 !
	s22 'largada =? ( drop ; ) drop
	sj2 0? ( -1 'puntos2 +! 'vallarota 's22 ! ) drop ;

:j2
	1.0 dup dim
	128 'h !
	0 0.4 fpos
	'arena nsprite

	128 qdim
	xs2 0.4 fpos
	s22 nsprite
	-0.005 'xs2 +!

	128 qdim
	xj2 yj2 0.4 + fpos
	'runa2 seqAnima nsprite
	'fruta2 nsprite
	'runb2 seqAnima nsprite
	'salto2 <ctrl>
	sj2 1? ( saltando2 ) drop

   	128 qdim
	xf2 0.4 fpos
	s21 nsprite
	-0.005 'xf2 +!

	xf2 xj2 <? ( valla2 ) drop
	;

:reset
	0 'd1 !
	0 'xj1 !
	0 'yj1 !
	0 'ay1 !
	0 'sj1 !

	0.0 'xf1 !
	-1.5 'xs1 !
	'largada 's11 !
	'valla 's12 !
	0 'v1 !

	0.0 'xf2 !
	-1.5 'xs2 !
	'largada 's21 !
	'valla 's22 !
	0 'v2 !
	;

:juego
	reset
	33
	show clrscr
		dup "%d " print cr
		puntos1 "%d " print

		j1
        j2
		'exit >esc< ;


: juego ;