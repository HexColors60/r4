^r4/lib/gui.txt
^r4/lib/bmr.txt

^inc/1492.bmr
^inc/1492.spr

#wb #hb

#sina #cosa
#wi #hi
#sx #sy

:drawbox | x y rot adr
	@ dup 12 >> $fff and 'wb ! $fff and 'hb !
	neg sincos 'cosa ! 'sina !
	cosa wb *
	sina hb * neg
	2dup +
	pick2 pick2 pick2
	min min 0 min 'sx !
	max max 0 max sx - 16 >> 'wi !

	sina hb *
	cosa wb *
	2dup +
	pick2 pick2 pick2
	min min 0 min 'sy !
	max max 0 max sy - 16 >> 'hi !

	verde
	over sx 16 >> +
	over sy 16 >> +
	2dup op
	over wi + over line
	over wi + over hi + line
	2dup hi + line
	line

	2drop
	;

:drawbox2 | x y rot adr
	rojo
	@ dup 12 >> $fff and 'wb ! $fff and 'hb !
	neg sincos
	wb * swap hb * swap
	over neg
	2dup +
	pick2 pick2 pick2
	min min 0 min 'sx !
	pick2 pick2 pick2
	max max 0 max sx - 16 >> 'wi !
	2drop
	2dup +
	pick2 pick2 pick2
	min min 0 min 'sy !
	max max 0 max sy - 16 >> 'hi !

	rojo
	over sx 16 >> +
	over sy 16 >> +
	2dup op
	over wi + over line
	over wi + over hi + line
	2dup hi + line
	line

	2drop ;

:main
	33
	show clrscr verde
		dup "%d" print
		sw 2/ sh 2/ msec 4 << 'arbol bmr.drawr
|		sw 2/ sh 2/ 0.2 'arbol bmr.drawr
|		sw 2/ sh 2 >> 'arbol bmr.draw

|		sw 2/ sh 2/ msec 4 << 'arbol drawbox
		sw 2/ sh 2/ 0.2 'arbol drawbox2
		cmano
		'exit >esc< ;

: main ;
